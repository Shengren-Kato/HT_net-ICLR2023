# VFMM-ICLR2023

# Datasets
The data is courtesy of [Zongyi Li (Caltech)](https://github.com/zongyi-li/fourier_neural_operator)  under the MIT license. Download the following data from [here](https://drive.google.com/drive/folders/1UnbQh2WWc6knEHbLn-ZaXrKUZhp7pjt-?usp=sharing):
>`burgers_data_R10.mat`
<br>`piececonst_r421_N1024_smooth1.mat`
<br>`piececonst_r421_N1024_smooth2.mat`
<br>`NavierStokes_V1e-3_N5000_T50.mat`
<br>`NavierStokes_V1e-4_N10000_T30.mat`
<br>`NavierStokes_V1e-5_N1200_T20.mat`.

The data of experiment darcy_rough(section 4.2) is generated by the code of [Zongyi Li (Caltech)](https://github.com/zongyi-li/fourier_neural_operator). Download the following data from [here](https://drive.google.com/drive/folders/1ovfK0CV6n_UUqt4tAtaxo_-9nRshhZC7?usp=sharing):
<br>`darcy_rough_train.mat`
<br>`darcy_rough_val.mat`
<br>`darcy_rough_test.mat`
<br>`darcy_alpha2_tau18_c3_512_test.mat`

In order to run the program properly, please add the data path to utilities3.py/getPath(). Run the vFMM_multi.py to verify the experiments.



The data of Multiscale trigonometric coefficient can be downloaded from [here](https://drive.google.com/drive/folders/1ovfK0CV6n_UUqt4tAtaxo_-9nRshhZC7?usp=sharing):
<br>`mul_tri_train.mat`
<br>`mul_tri_val.mat`
<br>`mul_tri_test.mat`

The data of Helmholtz equation(Appendix F) can be downloaded from [here](https://data.caltech.edu/records/fp3ds-kej20)

# Requirements
The reference [requirements.txt](https://github.com/Shengren-Kato/HT_net-ICLR2023/blob/main/vFMM_ICLR2023/requirements.txt) is under folder [vFMM_ICLR2023](https://github.com/Shengren-Kato/HT_net-ICLR2023/tree/main/vFMM_ICLR2023).

# Examples
To verify experiment darcy smooth in Section4.2, please fill in the data path of <br>`piececonst_r421_N1024_smooth1.mat` and <br>`piececonst_r421_N1024_smooth2.mat` on line 373 and 375 in [utilities3.py](https://github.com/Shengren-Kato/HT_net-ICLR2023/blob/main/vFMM_ICLR2023/utilities3.py).

To verify experiment darcy rough in Section4.2, please fill in the data path of <br>`darcy_rough_train.mat`, <br>`darcy_rough_val.mat` ,<br>`darcy_rough_test.mat`and <br>`darcy_alpha2_tau18_c3_512_test.mat` on line 380, 382 and 384 in [utilities3.py](https://github.com/Shengren-Kato/HT_net-ICLR2023/blob/main/vFMM_ICLR2023/utilities3.py).

Run the [vFMM_multi.py](https://github.com/Shengren-Kato/HT_net-ICLR2023/blob/main/vFMM_ICLR2023/vFMM_multi.py) to get the result of experimet darcy rough with reslution = 256.



